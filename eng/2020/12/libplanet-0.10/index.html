<!doctype html><html lang prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:title" content="Libplanet 0.10 Released"><meta property="og:site_name" content="Planetarium Engineering Snack"><meta property="og:image" content="https://snack.planetarium.dev/og/eng.png"><meta property="og:url" content="https://snack.planetarium.dev/eng/2020/12/libplanet-0.10/"><meta property="og:locale" content><meta property="article:published_time" content="2020-12-08"><meta property="article:modified_time" content="2020-12-08"><meta name=twitter:card content="summary"><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta name=twitter:title content="Libplanet 0.10 Released | Planetarium Engineering Snack"><meta name=twitter:description content="Hello Everyone! We have released the tenth minor version of Libplanet, Version 0.10.
Libplanet is a common library that solves game implementation problems such as P2P communication and data synchronization when creating online multiplayer games that run on distributed P2P.
In this version, Libplanet has made many changes both inside and outside the interface, including the use of MPT to manage Libplanet&rsquo;s state and additional APIs for asset management.
This piece addresses key major changes in Version 0.|"><meta name=twitter:image:src content><meta name=twitter:domain content="https://snack.planetarium.dev/eng/2020/12/libplanet-0.10/"><title>Libplanet 0.10 Released</title>
<link rel=canonical href=https://snack.planetarium.dev/eng/2020/12/libplanet-0.10/><link rel=alternate href=https://snack.planetarium.dev/kor/2020/12/libplanet-0.10/ hreflang=ko title="Libplanet 0.10 릴리스"><link href=https://snack.planetarium.dev/index.xml rel=alternate type=application/atom+xml title="Libplanet 0.10 Released"><link rel=stylesheet href=https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css><link rel=stylesheet href=https://snack.planetarium.dev/css/style.min.1a35efb5c5da4fd20bd2ec86458da5ee7cc1cfc81c4f107944b5e0fc59a3d809.css integrity="sha256-GjXvtcXaT9IL0uyGRY2l7nzBz8gcTxB5RLXg/Fmj2Ak="><script async src="https://www.googletagmanager.com/gtag/js?id=UA-132504786-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-132504786-2")</script><link rel=icon href=/favicon-32x32.png type=image/png sizes=32x32><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body class="sans-serif w-90 w-60-ns center center-ns mv2 mv5-ns" itemscope itemtype=http://schema.org/Article><a href=https://snack.planetarium.dev/eng/ id=site-title class="b bb bw1 pb1 no-underline dark-gray">Planetarium Engineering Snack</a><section id=main class=mt5><h1 itemprop=name id=title class=mb1>Libplanet 0.10 Released</h1><div class="f6 gray dib-ns"><time itemprop=datePublished datetime=2020-12-08>December 8, 2020
</time>(<strong>English</strong>
&bull;
<a href=https://snack.planetarium.dev/kor/2020/12/libplanet-0.10/ hreflang=ko title="Libplanet 0.10 릴리스" class=gray>한국어</a>)</div><article itemprop=articleBody id=content class="w-100 lh-copy"><p>Hello Everyone! We have released the tenth minor version of <a href=https://libplanet.io/>Libplanet</a>, <a href=https://github.com/planetarium/libplanet/releases/tag/0.10.0>Version 0.10</a>.</p><p>Libplanet is a common library that solves game implementation problems such as P2P communication and data synchronization when creating online multiplayer games that run on distributed P2P.</p><p>In this version, Libplanet has made many changes both inside and outside the interface, including the use of <a href=https://eth.wiki/en/fundamentals/patricia-tree><abbr title="Merkle–Patricia Trie">MPT</abbr></a> to manage Libplanet&rsquo;s state and additional APIs for asset management.</p><p>This piece addresses key major changes in Version 0.10.</p><h2 id=result-state-is-now-included-in-blockthash>Result State is Now Included in <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blocks.Block-1.html#Libplanet_Blocks_Block_1_Hash><code>Block&lt;T>.Hash</code></a></h2><p>Until now, <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blocks.Block-1.html><code>Block&lt;T></code></a> did not have any information about the state of the block. And while you could derive the state from the block itself, the only way to verify the consistency of the block&rsquo;s state was to run the action directly. However, <code>Block&lt;T>.Hash</code> is now derived not only with information about the block, but also with <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blocks.Block-1.html#Libplanet_Blocks_Block_1_StateRootHash><code>Block&lt;T>.StateRootHash</code></a>, which is the hash value of the evaluated actions in the block. As before, the hash value without the evaluated actions is placed in the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blocks.Block-1.html#Libplanet_Blocks_Block_1_PreEvaluationHash><code>Block&lt;T>.PreEvaluationHash</code></a> property.</p><h2 id=blockttotaldifficulty><a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blocks.Block-1.html#Libplanet_Blocks_Block_1_TotalDifficulty><code>Block&lt;T>.TotalDifficulty</code></a></h2><p>Originally, the block height (<a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blocks.Block-1.html#Libplanet_Blocks_Block_1_Index><code>Block&lt;T>.Index</code></a>) was the only criteria for selecting a canonical chain in the blockchain. However, since it is common for a network to have multiple blocks of the same height at a similar rate, agreements were often only made locally, causing the canonical chain to be indeterministic. To fix this ambiguity, the new version includes <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blocks.Block-1.html#Libplanet_Blocks_Block_1_TotalDifficulty><code>Block&lt;T>.TotalDifficulty</code></a> in the selection criteria to always have one option for the canonical chain. <code>Block&lt;T>.TotalDifficulty</code> property is the difficulty level of all blocks from itself to the genesis block. This has also improved security to some level because you can&rsquo;t force your chain as canonical simply by quickly stacking low-difficulty blocks.</p><h2 id=abbr-titlemerklepatricia-triemptabbr><abbr title="Merkle–Patricia Trie">MPT</abbr></h2><p><abbr title="Merkle–Patricia Trie">MPT</abbr> is a trie data structure used to store states in Ethereum, etc. Previously, the block state stored changes in the global state on a block-by-block basis and it was retrieved by querying through an index called the state reference. This took a long time when looking up a state that had not been updated for a while. Now we can check the state much faster through the MPT structure.</p><p>And to help with debugging, the newly added <code>planet mpt</code> command makes it easy to compare states between blocks, or import them from specific block. Please refer to the <code>planet mpt --help</code> option for instructions on how to use it.</p><h2 id=separate-state-api-for-assets>Separate State API for Assets</h2><p>So far, in-game goods have been treated the same way as in-game states when creating games with Libplanet. For example, <abbr title="Nine Chronicles Gold">NCG</abbr> is implemented as an arbitrarily large integer. Although such goods should never be replicated or destroyed carelessly, implementing them in a data type that is free of proprietary computation and doesn&rsquo;t necessarily hold the characteristics of the goods is prone to bugs.</p><p>For instance, when money is transferred, the sender&rsquo;s balance should be reduced and the recipient&rsquo;s balance should be increased. However, bugs that skip updating either the sender&rsquo;s or the recipient&rsquo;s balance could take place. Also, bugs that distribute the money to multiple people and bugs that unintentionally delete remaining amounts after division are possible.</p><p>And even more critically, when a programmer carelessly writes a code that just adds money to players&rsquo; balance as a game reward, this could affect the game economy as a whole and is practically like casting money privately.</p><p>To prevent these issues early on, this version has a separate state API for primarily dealing with assets. The <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.BlockChain-1.html#Libplanet_Blockchain_BlockChain_1_GetBalance_Libplanet_Address_Libplanet_Assets_Currency_System_Nullable_Libplanet_HashDigest_SHA256___Libplanet_Blockchain_FungibleAssetStateCompleter__0__><code>BlockChain&lt;T>.GetBalance()</code></a> and <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Action.IAccountStateDelta.html#Libplanet_Action_IAccountStateDelta_GetBalance_Libplanet_Address_Libplanet_Assets_Currency_><code>IAccountStateDelta.GetBalance()</code></a> methods are created alongside the existing <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.BlockChain-1.html#Libplanet_Blockchain_BlockChain_1_GetState_Libplanet_Address_System_Nullable_Libplanet_HashDigest_SHA256___Libplanet_Blockchain_StateCompleter__0__><code>BlockChain&lt;T>.GetState()</code></a> and <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Action.IAccountStateDelta.html#Libplanet_Action_IAccountStateDelta_GetState_Libplanet_Address_><code>IAccountStateDelta.GetState()</code></a> methods. And in addition to the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Action.IAccountStateDelta.html#Libplanet_Action_IAccountStateDelta_SetState_Libplanet_Address_IValue_><code>IAccountStateDelta.SetState()</code></a> method which can freely update states, <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Action.IAccountStateDelta.html#Libplanet_Action_IAccountStateDelta_SetState_Libplanet_Address_IValue_><code>IAccountStateDelta.TransferAsset()</code></a> method for transferring assets and <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Action.IAccountStateDelta.html#Libplanet_Action_IAccountStateDelta_MintAsset_Libplanet_Address_Libplanet_Assets_FungibleAssetValue_><code>IAccountStateDelta.MintAsset()</code></a> method for minting assets have been created.</p><p>Also, instead of using .NET&rsquo;s built-in <a href="https://docs.microsoft.com/en-us/dotnet/api/system.numerics.biginteger?view=net-5.0"><code>BigInteger</code></a> type, you need to use the new <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Assets.FungibleAssetValue.html><code>FungibleAssetValue</code></a> type added to Libplanet. <code>FungibleAssetValue</code> basically looks like a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.numerics.biginteger?view=net-5.0"><code>BigInteger</code></a>, but there are some differences.</p><ol><li>In division, the remaining values are never implicitly discarded and are always treated explicitly.
Therefore, instead of implementing the division operator( <code>/</code>), only the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Assets.FungibleAssetValue.html#Libplanet_Assets_FungibleAssetValue_DivRem_Libplanet_Assets_FungibleAssetValue_><code>DivRem()</code></a> method is implemented.</li><li>It supports minor currency units, such as dollar–cent, and limits the number of digits in the lower unit.</li><li>It preserves the unit of currency of each value so that different currencies do not mix.
To implement No.3 above, the data type <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Assets.Currency.html><code>Currency</code></a> is created to define the monetary unit. Its property includes the name of the currency unit, ticker symbol, and the number of digits in the lower unit.</li></ol><p>Currently, asset state API only supports fungible assets such as game money, but it will also support <a href=https://en.wikipedia.org/wiki/Non-fungible_token><abbr title="non-fungible token">NFT</abbr></a> such as game items in the future.</p><h2 id=new-rendering-api>New Rendering API</h2><p>Previously, the action class had to implement the <a href=https://docs.libplanet.io/0.9.2/api/Libplanet.Action.IAction.html#Libplanet_Action_IAction_Render_Libplanet_Action_IActionContext_Libplanet_Action_IAccountStateDelta_><code>Render()</code></a> method to reflect the result of the action on the screen. However, this previous API caused the view to mix into the action class that corresponded to pure logic.</p><p>For example, if you try to create a full game frontend with a 3D game engine and a wallet frontend that only shows simple notification and in-game assets based on the same blockchain, the <code>Render()</code> method either contains all the code required on both sides or follows the call pattern that places the callback in the global state. This is because a single action cannot implement various renderings.</p><p>To address this problem, the new version eliminates the <code>Render()</code> and <a href=https://docs.libplanet.io/0.9.2/api/Libplanet.Action.IAction.html#Libplanet_Action_IAction_Unrender_Libplanet_Action_IActionContext_Libplanet_Action_IAccountStateDelta_><code>Unrender()</code></a> methods in the <a href=https://docs.libplanet.io/0.9.2/api/Libplanet.Action.IAction.html><code>IAction</code></a> interface, and instead introduces a new <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Renderers.IRenderer-1.html><code>IRenderer&lt;T></code></a> interface and its subtype <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Renderers.IActionRenderer-1.html><code>IActionRenderer&lt;T></code></a>. The frontend has its own implementation of <code>IRenderer&lt;T></code> or <code>IActionRenderer&lt;T></code>, and they can be connected at creation of the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.BlockChain-1.html><code>BlockChain&lt;T></code></a> object.</p><p>When you only need a simple rendering, we recommend that you use the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Renderers.AnonymousRenderer-1.html><code>AnonymousRenderer&lt;T></code></a> class instead of creating your own class that implements the interface.<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>
Also, in the new rendering API, the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Renderers.IActionRenderer-1.html#Libplanet_Blockchain_Renderers_IActionRenderer_1_RenderActionError_Libplanet_Action_IAction_Libplanet_Action_IActionContext_Exception_><code>IActionRenderer&lt;T>.RenderActionError()</code></a> method addresses exceptions from actions, the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Renderers.IRenderer-1.html#Libplanet_Blockchain_Renderers_IRenderer_1_RenderBlock_Libplanet_Blocks_Block__0__Libplanet_Blocks_Block__0__><code>IRenderer&lt;T>.RenderBlock()</code></a> method detects the height change in the blockchain, and the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Renderers.IRenderer-1.html#Libplanet_Blockchain_Renderers_IRenderer_1_RenderReorg_Libplanet_Blocks_Block__0__Libplanet_Blocks_Block__0__Libplanet_Blocks_Block__0__><code>IRenderer&lt;T>.RenderReorg()</code></a> method detects the occurrence of a reorg<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. The separation of the rendering code from the action into an independent unit called renderer allows middleware structure through decorator pattern. For example, the new version&rsquo;s <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Renderers.LoggedRenderer-1.html><code>LoggedRenderer&lt;T></code></a> class wraps other <code>IRenderer&lt;T></code> implementations and logs which rendering events occurred at what point. When debugging, you can wrap the game renderer with <code>LoggedRenderer&lt;T></code> and take it out in the actual production.</p><h2 id=delayed-renderer>Delayed Renderer</h2><p>Since Libplanet currently uses a <abbr title=proof-of-work>PoW</abbr> mechanism which has only <em>probabilistic</em> finality, recent blocks are prone to reorg. For this reason, many cryptocurrency wallets and exchanges often show transactions&rsquo; number of confirmations because the higher the number of confirmations, the less likely a reorg occurs. In order to prevent confusion in the game due to frequent reorg in the blockchain, a delayed renderer has been added. <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Renderers.DelayedRenderer-1.html><code>DelayedRenderer&lt;T></code></a> is a decorator that receives <code>IRenderer&lt;T></code> as an input and implements <code>IRenderer&lt;T></code> on its own, virtually acting as a middleware that delays rendering events. So instead of immediately generating related events when new blocks are stacked in the blockchain, the delayed renderer waits until it meets the number of confirmations you have set. <a href=https://nine-chronicles.com/>Nine Chronicles</a> also uses a delayed renderer, and the number of confirmations is available as an option for the player to set.<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><h2 id=static-analyzer><a href=https://github.com/planetarium/libplanet/tree/main/Libplanet.Analyzers>Static Analyzer</a></h2><p>In Libplanet, the state within all blockchain can only be changed through an action. Because actions are executed separately on each node to derive a new state from the previous state and all nodes need to agree on a consistent state, an action must be deterministic. However, despite knowing what makes the code non-deterministic, it&rsquo;s not that simple to make a complex logic deterministic. You can make mistakes knowingly, and especially when multiple people work on the code, each deterministic portion implemented by different people can easily be combined to derive a non-deterministic result.</p><p>To address this issue, the new version introduces <a href=https://www.nuget.org/packages/Libplanet.Analyzers>Libplanet.Analyzers Package</a>, which checks for errors in the Libplanet action code through static analysis. This static analyzer alerts you in advance to potential bugs that are common, based on repeated mistakes we&rsquo;ve made in developing Nine Chronicles. It&rsquo;s very easy to use, just add it as a NuGet package dependency and it will output as a warning along with a C# compiler error when built.</p><p>However, since it&rsquo;s still an early version, the number of checks is not diversified, and there are some potential bug warnings even though the code is written correctly. These will gradually be improved in future versions.</p><h2 id=byte-size-and-number-of-transactions-per-block-limited>Byte Size and Number of Transactions per Block Limited</h2><p>Until now, Libplanet did not limit the block size or the number of transactions a block could take. Without this limitation, however, the network was open to malicious attacks and too many transactions contained in a single block often caused latency issues.</p><p>To address this issue, the new version allows the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Policies.IBlockPolicy-1.html#Libplanet_Blockchain_Policies_IBlockPolicy_1_GetMaxBlockBytes_System_Int64_><code>GetMaxBlockBytes()</code></a> method and <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Policies.IBlockPolicy-1.html#Libplanet_Blockchain_Policies_IBlockPolicy_1_MaxTransactionsPerBlock><code>MaxTransactionsPerBlock</code></a> properties in the <a href=https://docs.libplanet.io/0.10.2/api/Libplanet.Blockchain.Policies.IBlockPolicy-1.html><code>IBlockPolicy&lt;T></code></a> interface to provide network settings that limit the block size and the maximum number of transactions per block. When the miner creates a block, it takes in the number of transactions limited by the network, and even if a malicious node creates and propagates blocks that exceed the network settings, other nodes will see the block as invalid.</p><p>Since optimal settings may vary depending on the network or application, it is recommended to adjust the settings by operating a pilot network during the development phase.</p><h2 id=furthermore>Furthermore</h2><p>You can learn more about additional changes in our <a href=https://github.com/planetarium/libplanet/releases/tag/0.10.0>release notes</a>.</p><p>And as always, if you have any questions about the new release or Libplanet in general, please visit our <a href=https://discord.gg/planetarium>Discord chatroom</a> and let’s chat!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Unlike Java, C# doesn&rsquo;t have an anonymous class.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>For more information on reorg, refer to Muhun Kim&rsquo;s <a href=https://snack.planetarium.dev/eng/2020/10/decentralized-and-online-game-intersect/>Decentralization Intersects with Online Game</a>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>The number of confirmations currently can&rsquo;t be adjusted on the UI, but it can be changed directly in the configuration file.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><script>(function(){if(!location.hash.match(/^#/))return;var t,n,s,a,o=document.getElementById("content"),r=window.decodeURIComponent(location.hash.substring(1)),i=document.getElementById(r),e=i.nodeName.match(/^H([123456])$/);if(!e||i.parentNode!==o)return;for(a=window.parseInt(e[1]),t=!1,s=0;s<o.childNodes.length;s++)n=o.childNodes[s],t?(e=n.nodeName.match(/^H([123456])$/),e&&window.parseInt(e[1])>=a&&(t=!1)):n===i&&(t=!0),!t&&!n.nodeName.match(/^#/)&&(n.className+=" dim")})()</script><div itemprop=author class="fl tc mr3"><a href=https://github.com/riemannulus rel=author itemprop=url class="no-underline mid-gray b f6"><img src="https://www.gravatar.com/avatar/9e43b4f2a202a9d7a1e2b180aaaba253?d=https://avatars.githubusercontent.com/riemannulus" itemprop=image class="w3 h3 br-100 mb1"><br>Suho Lee</a></div></section><footer><div><p class="f6 gray mt6 lh-copy">&copy; 2019&ndash;2023
<a href=https://planetariumlabs.com/ style=color:inherit;text-decoration:inherit>Planetarium</a>.</p></div></footer></body></html>