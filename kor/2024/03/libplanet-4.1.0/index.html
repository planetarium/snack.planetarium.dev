<!doctype html><html lang=ko prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:title" content="Libplanet 4.0 릴리스"><meta property="og:site_name" content="플라네타리움 엔지니어링 스낵"><meta property="og:url" content="https://snack.planetarium.dev/kor/2024/03/libplanet-4.1.0/"><meta property="og:locale" content="ko"><meta property="article:published_time" content="2024-03-12"><meta property="article:modified_time" content="2024-03-12"><meta name=twitter:card content="summary"><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta name=twitter:title content="Libplanet 4.0 릴리스 | 플라네타리움 엔지니어링 스낵"><meta name=twitter:description content="안녕하세요.  Libplanet의 네 번째 메이저 버전인 4.0 버전이
릴리스되었습니다.
Libplanet은 분산 P2P로 돌아가는 온라인 멀티플레이어 게임을 만들 때,
매번 구현해야 하는 P2P 통신이나 데이터 동기화 등의 문제를 푸는
공용 라이브러리입니다.
이번 버전부터 Libplanet은 상태를 조금 더 효율적으로 다루기 위해, 여러 Account
를 다룰 수 있는 World 를 도입하였고, 버전 마이그레이션을 큰 문제 없이 할 수 있도록
여러 API를 제공하고 있습니다.
이 글에서는 4.0 버전의 주요 변경 사항들에 대해서 다루겠습니다.|"><meta name=twitter:image:src content><meta name=twitter:domain content="https://snack.planetarium.dev/kor/2024/03/libplanet-4.1.0/"><title>Libplanet 4.0 릴리스</title>
<link rel=canonical href=https://snack.planetarium.dev/kor/2024/03/libplanet-4.1.0/><link href=https://snack.planetarium.dev/index.xml rel=alternate type=application/atom+xml title="Libplanet 4.0 릴리스"><link rel=stylesheet href=https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css><link rel=stylesheet href=https://snack.planetarium.dev/css/style.min.1a35efb5c5da4fd20bd2ec86458da5ee7cc1cfc81c4f107944b5e0fc59a3d809.css integrity="sha256-GjXvtcXaT9IL0uyGRY2l7nzBz8gcTxB5RLXg/Fmj2Ak="><script async src="https://www.googletagmanager.com/gtag/js?id=UA-132504786-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-132504786-2")</script><link rel=icon href=/favicon-32x32.png type=image/png sizes=32x32><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body class="sans-serif w-90 w-60-ns center center-ns mv2 mv5-ns" itemscope itemtype=http://schema.org/Article><a href=https://snack.planetarium.dev/kor/ id=site-title class="b bb bw1 pb1 no-underline dark-gray">플라네타리움 엔지니어링 스낵</a><section id=main class=mt5><h1 itemprop=name id=title class=mb1>Libplanet 4.0 릴리스</h1><div class="f6 gray dib-ns"><time itemprop=datePublished datetime=2024-03-12>2024년 3월 12일</time></div><article itemprop=articleBody id=content class="w-100 lh-copy"><p>안녕하세요. <a href=https://libplanet.io/>Libplanet</a>의 네 번째 메이저 버전인 <a href=https://github.com/planetarium/libplanet/releases/tag/4.0.0>4.0 버전</a>이
릴리스되었습니다.</p><p>Libplanet은 분산 P2P로 돌아가는 온라인 멀티플레이어 게임을 만들 때,
매번 구현해야 하는 P2P 통신이나 데이터 동기화 등의 문제를 푸는
공용 라이브러리입니다.</p><p>이번 버전부터 Libplanet은 상태를 조금 더 효율적으로 다루기 위해, 여러 <a href=https://docs.libplanet.io/4.1.0/api/Libplanet.Action.State.Account.html>Account</a>
를 다룰 수 있는 <a href=https://docs.libplanet.io/4.1.0/api/Libplanet.Action.State.World.html>World</a> 를 도입하였고, 버전 마이그레이션을 큰 문제 없이 할 수 있도록
여러 API를 제공하고 있습니다.</p><p>이 글에서는 4.0 버전의 주요 변경 사항들에 대해서 다루겠습니다.</p><h2 id=여러-sub-state-를-들-수-있게-된-libplanet>여러 Sub-state 를 들 수 있게 된 Libplanet</h2><p>그동안 Libplanet 은 단 하나의 상태 저장소 만을 가질 수 있었습니다. 이는 초기 개발에는 복잡한
<code>Sub-state</code> 유도 과정 등을 생략하고, 하나의 공유 데이터를 사용함으로써 많은 이점을 가질 수 있었습니다.</p><p>하지만 게임의 규모가 커짐에 따라, 한 Address 가 여러 상태 모델을 가지고 싶어하는 상황이 생겼습니다.
Libplanet 은 그동안 해당 Address 로부터 유도 된 새로운 Address 에 모델을 저장하는 방식을 채택하였습니다.
그래프로 그리면 다음과 같습니다.</p><pre class=mermaid>flowchart LR
    A[User Address] -->|"Derive(User, 'Avatar')"| B[Avatar Address]
    A --> |"Get(User Address)"| S[Storage]
    B --> |"Get(Avatar Address)"| S
  </pre><p>이는 한 스토리지에 여러 데이터를 저장하게 되어 성능이나 권한 문제에서 자유로울 수 없었습니다.</p><p>이런 문제를 해결하기 위해, Libplanet 은 기존의 하나 밖에 없던 <a href=https://docs.libplanet.io/3.6.0/api/Libplanet.Action.State.Account.html><code>Account</code></a>를
<a href=https://docs.libplanet.io/4.1.0/api/Libplanet.Action.State.IWorldState.html#Libplanet_Action_State_IWorldState_Legacy><code>World.Legacy</code></a> 로 만들고, <a href=https://docs.libplanet.io/4.1.0/api/Libplanet.Action.State.IWorld.html><code>World</code></a> 밑에 여러 <a href=https://docs.libplanet.io/3.6.0/api/Libplanet.Action.State.Account.html><code>Account</code></a> 를 가질 수 있게 하였습니다.</p><pre class=mermaid>flowchart LR
    A[User Address] --> |"Get(User)"| S1["Avatar Storage"]
    A[User Address] --> |"Get(User)"| S2["Agent Storage"]
    S1 --> Avatar
    S2 --> Agent
  </pre><p>이런 문제로, 이전과 같이 직접적으로 <a href=https://docs.libplanet.io/4.1.0/api/Libplanet.Action.IActionContext.html#Libplanet_Action_IActionContext_PreviousState><code>IActionContext.PreviousState</code></a> 혹은
<a href=https://docs.libplanet.io/4.1.0/api/Libplanet.Action.IActionEvaluation.html#Libplanet_Action_IActionEvaluation_OutputState><code>IActionEvaluation.OutputState</code></a>로부터 데이터를 읽어 올 수는 없습니다. 따라서
<a href=https://docs.libplanet.io/4.1.0/api/Libplanet.Action.IAction.html#Libplanet_Action_IAction_Execute_Libplanet_Action_IActionContext_><code>IAction.Execute()</code></a>안에서의 API 는 다음과 같이 변경됩니다.</p><div class=highlight><pre tabindex=0 style=background-color:#fff><code class=language-csharp data-lang=csharp><span style=display:flex><span>IWorld world = context.PreviousState
</span></span><span style=display:flex><span>IAccount avatarAccount = world.GetAccount(<span style=color:#080;font-weight:700>new</span> Address(<span style=color:#d20;background-color:#fff0f0>&#34;0x0000000000000000&#34;</span>))
</span></span><span style=display:flex><span>IValue avatarList = avatarAccount.GetState(context.Signer)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>IAccount agentAccount = world.GetAccount(<span style=color:#080;font-weight:700>new</span> Address(<span style=color:#d20;background-color:#fff0f0>&#34;0x0000000000000001&#34;</span>))
</span></span><span style=display:flex><span>IValue agent = agentAccount.GetState(context.Signer)
</span></span></code></pre></div><p>각 도메인에 맞는 <code>Account</code> 를 가져오는 점에 주의하십시오.</p><h2 id=그-외>그 외</h2><p>그 외에도 여러 성능 개선이나 자잘한 마이너 패치가 있었습니다. 자세한 내용은 <a href=https://github.com/planetarium/libplanet/releases/tag/4.0.0>전체 변경 내용</a> 에서 확인해 주세요.</p><p>질문이나 관심이 있으신 분들은 또한 저희 <a href=https://discord.gg/YaHPjcrdrw>Discord</a> 채널에 놀러와 주세요!</p></article><script>(function(){if(!location.hash.match(/^#/))return;var t,n,s,a,o=document.getElementById("content"),r=window.decodeURIComponent(location.hash.substring(1)),i=document.getElementById(r),e=i.nodeName.match(/^H([123456])$/);if(!e||i.parentNode!==o)return;for(a=window.parseInt(e[1]),t=!1,s=0;s<o.childNodes.length;s++)n=o.childNodes[s],t?(e=n.nodeName.match(/^H([123456])$/),e&&window.parseInt(e[1])>=a&&(t=!1)):n===i&&(t=!0),!t&&!n.nodeName.match(/^#/)&&(n.className+=" dim")})()</script><div class=recruit><a href=https://planetariumhq.com>플라네타리움</a>은 게임에 특화된
오픈 소스 P2P 라이브러리 <a href=https://libplanet.io/>Libplanet</a>과,
그 위에서 중앙 서버 없는 온라인 게임
〈<a href=https://nine-chronicles.com/>나인 크로니클</a>〉을 만들고
있습니다. 저희와 흥미로운 기술적 도전을 함께 하실 분들을 모시고 있습니다.
지금 <a href=https://recruit.planetariumhq.com/>인재 영입 페이지</a>를
확인해주세요!</div><div itemprop=author class="fl tc mr3"><a href=https://github.com/riemannulus rel=author itemprop=url class="no-underline mid-gray b f6"><img src="https://www.gravatar.com/avatar/9e43b4f2a202a9d7a1e2b180aaaba253?d=https://avatars.githubusercontent.com/riemannulus" itemprop=image class="w3 h3 br-100 mb1"><br>이수호</a></div></section><footer><div><p class="f6 gray mt6 lh-copy">&copy; 2019&ndash;2025
<a href=https://planetariumlabs.com/ style=color:inherit;text-decoration:inherit>Planetarium</a>.</p></div></footer><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script></body></html>