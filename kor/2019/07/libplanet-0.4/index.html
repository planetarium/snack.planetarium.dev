<!doctype html><html lang=ko prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:title" content="Libplanet 0.4 릴리스"><meta property="og:site_name" content="플라네타리움 엔지니어링 스낵"><meta property="og:image" content="https://snack.planetarium.dev/og/kor.png"><meta property="og:url" content="https://snack.planetarium.dev/kor/2019/07/libplanet-0.4/"><meta property="og:locale" content="ko"><meta property="article:published_time" content="2019-07-10"><meta property="article:modified_time" content="2019-07-10"><meta name=twitter:card content="summary"><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta name=twitter:title content="Libplanet 0.4 릴리스 | 플라네타리움 엔지니어링 스낵"><meta name=twitter:description content="안녕하세요. 저희 팀은 Libplanet의 네 번째 마이너 버전인 0.4 버전을 릴리스했습니다.
Libplanet은 분산 P2P로 돌아가는 온라인 멀티플레이어 게임을 만들 때, 그러한 게임들이 매번 구현해야 하는 P2P 통신이나 데이터 동기화 등의 문제를 푸는 공용 라이브러리입니다.
이 글에서는 0.4 버전의 주요 변경 사항에 대해 다루겠습니다.
LiteDBStore 추가 Libplanet은 저장 계층을 간추리기 위해 IStore라는 인터페이스와 이를 파일 기반으로 구현한 FileStore를 기본으로 제공합니다. 이 FileStore는 작은 규모의 게임에서 사용하기엔 충분했지만, 더 큰 규모의 게임에 적용해보니 다음과 같은 문제가 있었습니다.|"><meta name=twitter:image:src content><meta name=twitter:domain content="https://snack.planetarium.dev/kor/2019/07/libplanet-0.4/"><title>Libplanet 0.4 릴리스</title><link rel=canonical href=https://snack.planetarium.dev/kor/2019/07/libplanet-0.4/><link rel=alternate href=https://snack.planetarium.dev/eng/2019/07/libplanet-0.4/ hreflang=en title="Libplanet 0.4 Released"><link href=https://snack.planetarium.dev/index.xml rel=alternate type=application/atom+xml title="Libplanet 0.4 릴리스"><link rel=stylesheet href=https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css><link rel=stylesheet href=https://snack.planetarium.dev/css/style.min.e1d6437358a5772f79ae0fd01e6ee2736e7fc6536065652581cf2a9c461d4bb0.css integrity="sha256-4dZDc1ildy95rg/QHm7ic25/xlNgZWUlgc8qnEYdS7A="><script async src="https://www.googletagmanager.com/gtag/js?id=UA-132504786-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-132504786-2');</script><link rel=icon href=/favicon-32x32.png type=image/png sizes=32x32><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body class="sans-serif w-90 w-60-ns center center-ns mv2 mv5-ns" itemscope itemtype=http://schema.org/Article><a href=https://snack.planetarium.dev/kor/ id=site-title class="b bb bw1 pb1 no-underline dark-gray">플라네타리움 엔지니어링 스낵</a><section id=main class=mt5><h1 itemprop=name id=title class=mb1>Libplanet 0.4 릴리스</h1><div class="f6 gray dib-ns"><time itemprop=datePublished datetime=2019-07-10>2019년 7월 10일</time>
(<strong>한국어</strong>
&bull;
<a href=https://snack.planetarium.dev/eng/2019/07/libplanet-0.4/ hreflang=en title="Libplanet 0.4 Released" class=gray>English</a>)</div><article itemprop=articleBody id=content class="w-100 lh-copy"><p>안녕하세요. 저희 팀은 <a href=https://libplanet.io/>Libplanet</a>의 네 번째 마이너 버전인 <a href=https://github.com/planetarium/libplanet/releases/tag/0.4.0>0.4 버전</a>을 릴리스했습니다.</p><p>Libplanet은 분산 P2P로 돌아가는 온라인 멀티플레이어 게임을 만들 때, 그러한 게임들이 매번 구현해야 하는 P2P 통신이나 데이터 동기화 등의 문제를 푸는 공용 라이브러리입니다.</p><p>이 글에서는 0.4 버전의 주요 변경 사항에 대해 다루겠습니다.</p><h2 id=litedbstore-추가><code>LiteDBStore</code> 추가</h2><p>Libplanet은 저장 계층을 간추리기 위해 <a href=https://docs.libplanet.io/0.4.0/api/Libplanet.Store.IStore.html><code>IStore</code></a>라는 인터페이스와 이를 파일 기반으로 구현한 <a href=https://docs.libplanet.io/0.4.0/api/Libplanet.Store.FileStore.html><code>FileStore</code></a>를 기본으로 제공합니다. 이 <code>FileStore</code>는 작은 규모의 게임에서 사용하기엔 충분했지만, 더 큰 규모의 게임에 적용해보니 다음과 같은 문제가 있었습니다.</p><ul><li>모든 블록과 그 상태, 트랜잭션 그리고 계정의 주소 등이 각기 별도의 파일로 저장되는 방식이었기 때문에, 파일이 너무 많이 생겼습니다.</li><li>별도의 캐시나 버퍼가 없어 입출력 성능이 떨어졌습니다.</li></ul><p>저희는 이런 문제를 해결하고자 별도의 스토리지 엔진을 사용하는 <code>IStore</code> 구현의 필요성을 검토하였고, 그 과정에서 선택한 것이 바로 <a href=https://www.litedb.org/>LiteDB</a>입니다. LiteDB는 순수 C#으로 작성되어 있어 .NET 환경에서 이식성이 뛰어나고, 전체 데이터를 단일 파일로 관리할 수 있기 때문에 관리가 쉽습니다.</p><p>이렇게 작성된 <a href=https://docs.libplanet.io/0.4.0/api/Libplanet.Store.LiteDBStore.html><code>LiteDBStore</code></a>는 <code>IStore</code>를 구현하기 때문에, 기존 <code>FileStore</code>에서 객체 초기화 방법을 제외하곤 완전히 같은 방법으로 사용할 수 있습니다.</p><h2 id=간편한-트랜잭션-생성>간편한 트랜잭션 생성</h2><p>0.3 버전에 추가된 <a href=https://docs.libplanet.io/0.3.0/api/Libplanet.Tx.Transaction-1.html#Libplanet_Tx_Transaction_1_Nonce><code>Transaction&lt;T>.Nonce</code></a>는 안전한 트랜잭션을 만들기 위한 중요한 장치였지만, 동시에 Libplanet을 사용하는 개발자에게는 골칫거리기도 했습니다. <code>Transaction&lt;T></code>를 만들기 위해서는 반드시 <a href=https://docs.libplanet.io/0.3.0/api/Libplanet.Blockchain.BlockChain-1.html#Libplanet_Blockchain_BlockChain_1_GetNonce_Libplanet_Address_><code>BlockChain&lt;T>.GetNonce()</code></a>를 통해 현재 서명하는 계정의 정확한 <a href=https://en.wikipedia.org/wiki/Cryptographic_nonce>논스</a>를 얻어와서 사용해야 했기 때문이죠. 이는 단순히 번거로운 절차일 뿐만 아니라, 트랜잭션을 언제 만드느냐에 따라 동시성 문제를 일으키기도 했습니다.</p><p>하지만 0.4 버전부터는 <a href=https://docs.libplanet.io/0.4.0/api/Libplanet.Blockchain.BlockChain-1.html#Libplanet_Blockchain_BlockChain_1_MakeTransaction_Libplanet_Crypto_PrivateKey_System_Collections_Generic_IEnumerable__0__System_Collections_Immutable_IImmutableSet_Libplanet_Address__System_Nullable_System_DateTimeOffset__System_Boolean_><code>BlockChain&lt;T>.MakeTransaction()</code></a>를 통해 간편하면서 동시성 걱정 없이 트랜잭션을 만들 수 있습니다.</p><h2 id=트랜잭션-전파-자동화>트랜잭션 전파 자동화</h2><p>이전 버전까지의 Libplanet을 이용한 게임이 트랜잭션을 전파하기 위해선 <a href=https://docs.libplanet.io/0.3.0/api/Libplanet.Net.Swarm.html#Libplanet_Net_Swarm_BroadcastTxs__1_System_Collections_Generic_IEnumerable_Libplanet_Tx_Transaction___0___><code>Swarm.BroadcastTxs()</code></a>를 직접 호출해야 했습니다. 그런데 네트워크 장애 등의 이유로 트랜잭션 전파에 실패할 수 있기 때문에, 게임 쪽에서 직접 재시도 로직을 구현해야 했었죠.</p><p>(여전히 <code>.BroadcastTxs()</code>를 쓸 수도 있지만) 게임은 이제 이를 직접 처리하지 않아도 됩니다. 그 대신에 <code>Swarm&lt;T></code>을 만들 때 자신의 체인을 넣고 그 체인에 (위에서 소개한 <code>BlockChain&lt;T>.MakeTransaction()</code>을 사용해서) 트랜잭션을 만들기만 하면 되죠. 나머지는 전파 과정은 <code>Swarm&lt;T></code>가 알아서 수행합니다.</p><p>이 과정에서 <code>Swarm</code>이 직접 체인을 관리하기 때문에 <code>BlockChain&lt;T></code>처럼 타입 인자(<code>T</code>)를 가진 <code>Swarm&lt;T></code>으로 변경되었습니다.</p><h2 id=그-외>그 외</h2><p>그 외의 여러 가지 변경 사항은 <a href=https://github.com/planetarium/libplanet/releases/tag/0.4.0>전체 변경 내역</a>에서 확인하실 수 있습니다.</p><p>이번 변경 사항이나 Libplanet에 대해 궁금한 점이 있으시다면 언제든 저희 팀이 상주해 있는 <a href=https://discord.gg/planetarium>디스코드 대화방</a>에 놀러 오세요!</p></article><script>(function(){if(!location.hash.match(/^#/)){return;}
var article=document.getElementById('content');var id=window.decodeURIComponent(location.hash.substring(1));var heading=document.getElementById(id);var match=heading.nodeName.match(/^H([123456])$/);if(!match||heading.parentNode!==article){return;}
var headingLevel=window.parseInt(match[1]);var highlighted=false;for(var i=0;i<article.childNodes.length;i++){var child=article.childNodes[i];if(highlighted){match=child.nodeName.match(/^H([123456])$/);if(match&&window.parseInt(match[1])>=headingLevel){highlighted=false;}}
else if(child===heading){highlighted=true;}
if(!highlighted&&!child.nodeName.match(/^#/)){child.className+=' dim';}}})();</script><div class=recruit><a href=https://planetariumhq.com>플라네타리움</a>은 게임에 특화된 오픈 소스 P2P 라이브러리 <a href=https://libplanet.io/>Libplanet</a>과, 그 위에서 중앙 서버 없는 온라인 게임 <a href=https://nine-chronicles.com/>나인 크로니클</a>을 만들고 있습니다. 저희와 흥미로운 기술적 도전을 함께 하실 분들을 모시고 있습니다. 지금 <a href=https://recruit.planetariumhq.com/>채용 페이지</a>를 확인해주세요!</div><div itemprop=author class="fl tc mr3"><a href=https://github.com/longfin rel=author itemprop=url class="no-underline mid-gray b f6"><img src="https://www.gravatar.com/avatar/0b12cfcb4b1a472207af0e51f7d13a71?d=https://avatars.githubusercontent.com/longfin" itemprop=image class="w3 h3 br-100 mb1"><br>문성원</a></div></section><footer><div><p class="f6 gray mt6 lh-copy">&copy; 2019&ndash;2021
<a href=https://planetariumhq.com/ style=color:inherit;text-decoration:inherit>Planetarium</a>.</p></div></footer></body></html>